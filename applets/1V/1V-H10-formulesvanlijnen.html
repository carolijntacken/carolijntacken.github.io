<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<style>
body 
	{ 
	font-family: Arial, Helvetica, sans-serif; 
	margin-left: 20px; 
	margin-right: 20px;
	color: #454545;
	}
		
footer {
	clear: both;
	height: 90px;
	margin-top: 60px;
}

footer div {
	font-size: 0.7em;
	text-align: right;
	border-top: 1px solid #c0c0c0;
	margin: 10px 0px;
	padding: 10px 0px;
}

@media only screen and (max-device-width: 1024px) and (orientation: portrait)
{/* This block provides CSS that only applies to the iPad in portrait orientation */

	body
	{font-size: 130%;}

}

@media only screen and (max-device-width: 1024px) and (orientation: landscape)
{/* This CSS kicks in only when an iPad is in landscape mode. It makes the font bigger, the table rows taller, etc */

	body
	{font-size: 100%;}

}

.jxgbox {
    overflow:hidden;
    background-color:#ffffff;
    border-style:solid;
    border-width:1px;
    border-color:#C0C0C0;
   	-moz-box-shadow:black 2px 2px 2px -2px, #151A10 4px 4px;
    -webkit-box-shadow:4px 4px 3px #F0F0F0;
}

.JXGtext {
    background-color: transparent;
    font-family: Arial, Helvetica, Geneva;
    padding: 0px;
    margin: 0px;
}
	
</style>
<script type="text/javascript" src="https://jsxgraph.uni-bayreuth.de/~michael/jsxgraph-nightly/archive/2017/2017-01-31.2100/jsxgraphcore.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.processSectionDelay = 0;
</script>

<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML"></script>

<script type="text/javascript">
var sin=Math.sin,cos=Math.cos,tan=Math.tan,sqrt=Math.sqrt,ceil=Math.ceil,round=Math.round;var random=Math.random;function abs(x){return Math.abs(x)}var pi=Math.PI,ln=Math.log,e=Math.E;E=Math.E;var arcsin=Math.asin,arccos=Math.acos,arctan=Math.atan;var sec=function(x){return 1/Math.cos(x)};var csc=function(x){return 1/Math.sin(x)};var cot=function(x){return 1/Math.tan(x)};var arcsec=function(x){return arccos(1/x)};var arccsc=function(x){return arcsin(1/x)};var arccot=function(x){return arctan(1/x)};var sinh=function(x){return(Math.exp(x)-Math.exp(-x))/2};var cosh=function(x){return(Math.exp(x)+Math.exp(-x))/2};var tanh=function(x){return(Math.exp(x)-Math.exp(-x))/(Math.exp(x)+Math.exp(-x))};var sech=function(x){return 1/cosh(x)};var csch=function(x){return 1/sinh(x)};var coth=function(x){return 1/tanh(x)};var arcsinh=function(x){return ln(x+Math.sqrt(x*x+1))};var arccosh=function(x){return ln(x+Math.sqrt(x*x-1))};var arctanh=function(x){return ln((1+x)/(1-x))/2};var sech=function(x){return 1/cosh(x)};var csch=function(x){return 1/sinh(x)};var coth=function(x){return 1/tanh(x)};var arcsech=function(x){return arccosh(1/x)};var arccsch=function(x){return arcsinh(1/x)};var arccoth=function(x){return arctanh(1/x)};var sign=function(x){return(x==0?0:(x<0?-1:1))};var logten=function(x){return(Math.LOG10E*Math.log(x))};function factorial(x,n){if(n==null)n=1;for(var i=x-n;i>0;i-=n)x*=i;return(x<0?NaN:(x==0?1:x))}function C(x,k){var res=1;for(var i=0;i<k;i++)res*=(x-i)/(k-i);return res}function matchtolower(match){return match.toLowerCase()}function nthroot(n,base){return safepow(base,1/n)}function nthlogten(n,v){return((Math.log(v))/(Math.log(n)))}function safepow(base,power){if(base<0&&Math.floor(power)!=power){for(var j=3;j<50;j+=2){if(Math.abs(Math.round(j*power)-(j*power))<.000001){if(Math.round(j*power)%2==0){return Math.pow(Math.abs(base),power)}else{return-1*Math.pow(Math.abs(base),power)}}}return sqrt(-1)}else{return Math.pow(base,power)}}function mathjs(st,varlist){st=st.replace("[","(");st=st.replace("]",")");st=st.replace(/arc(sin|cos|tan)/g,"a#r#c $1");if(varlist!=null){var reg=new RegExp("(sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)[\(]","g");st=st.replace(reg,"$1#(");var reg=new RegExp("("+varlist+")("+varlist+")$","g");st=st.replace(reg,"($1)($2)");var reg=new RegExp("("+varlist+")(a#|sqrt|ln|log|sin|cos|tan|sec|csc|cot|abs|root)","g");st=st.replace(reg,"($1)$2");var reg=new RegExp("("+varlist+")("+varlist+")([^a-df-zA-Z\(#])","g");st=st.replace(reg,"($1)($2)$3");var reg=new RegExp("([^a-df-zA-Z#])("+varlist+")([^a-df-zA-Z#])","g");st=st.replace(reg,"$1($2)$3");var reg=new RegExp("^("+varlist+")([^a-df-zA-Z])","g");st=st.replace(reg,"($1)$2");var reg=new RegExp("([^a-df-zA-Z])("+varlist+")$","g");st=st.replace(reg,"$1($2)")}st=st.replace(/#/g,"");st=st.replace(/a#r#c\s+(sin|cos|tan)/g,"arc$1");st=st.replace(/\s/g,"");st=st.replace(/(Sin|Cos|Tan|Sec|Csc|Cot|Arc|Abs|Log|Ln|Sqrt)/g,matchtolower);st=st.replace(/log_(\d+)\(/,"nthlog($1,");st=st.replace(/log/g,"logten");if(st.indexOf("^-1")!=-1){st=st.replace(/sin\^-1/g,"arcsin");st=st.replace(/cos\^-1/g,"arccos");st=st.replace(/tan\^-1/g,"arctan");st=st.replace(/sec\^-1/g,"arcsec");st=st.replace(/csc\^-1/g,"arccsc");st=st.replace(/cot\^-1/g,"arccot");st=st.replace(/sinh\^-1/g,"arcsinh");st=st.replace(/cosh\^-1/g,"arccosh");st=st.replace(/tanh\^-1/g,"arctanh");st=st.replace(/sech\^-1/g,"arcsech");st=st.replace(/csch\^-1/g,"arccsch");st=st.replace(/coth\^-1/g,"arccoth")}st=st.replace(/root\((\d+)\)\(/,"nthroot($1,");st=st.replace(/([0-9])E([\-0-9])/g,"$1(EE)$2");st=st.replace(/^e$/g,"(E)");st=st.replace(/pi/g,"(pi)");st=st.replace(/^e([^a-zA-Z])/g,"(E)$1");st=st.replace(/([^a-zA-Z])e$/g,"$1(E)");st=st.replace(/([^a-zA-Z])e([^a-zA-Z])/g,"$1(E)$2");st=st.replace(/([0-9])([\(a-zA-Z])/g,"$1*$2");st=st.replace(/(!)([0-9\(])/g,"$1*$2");st=st.replace(/([0-9])\*\(EE\)([\-0-9])/,"$1e$2");st=st.replace(/\)([\(0-9a-zA-Z])/g,"\)*$1");var i,j,k,ch,nested;while((i=st.indexOf("^"))!=-1){if(i==0)return"Error: missing argument";j=i-1;ch=st.charAt(j);if(ch>="0"&&ch<="9"){j--;while(j>=0&&(ch=st.charAt(j))>="0"&&ch<="9")j--;if(ch=="."){j--;while(j>=0&&(ch=st.charAt(j))>="0"&&ch<="9")j--}}else if(ch==")"){nested=1;j--;while(j>=0&&nested>0){ch=st.charAt(j);if(ch=="(")nested--;else if(ch==")")nested++;j--}while(j>=0&&(ch=st.charAt(j))>="a"&&ch<="z"||ch>="A"&&ch<="Z")j--}else if(ch>="a"&&ch<="z"||ch>="A"&&ch<="Z"){j--;while(j>=0&&(ch=st.charAt(j))>="a"&&ch<="z"||ch>="A"&&ch<="Z")j--}else{return"Error: incorrect syntax in "+st+" at position "+j}if(i==st.length-1)return"Error: missing argument";k=i+1;ch=st.charAt(k);nch=st.charAt(k+1);if(ch>="0"&&ch<="9"||(ch=="-"&&nch!="(")||ch=="."){k++;while(k<st.length&&(ch=st.charAt(k))>="0"&&ch<="9")k++;if(ch=="."){k++;while(k<st.length&&(ch=st.charAt(k))>="0"&&ch<="9")k++}}else if(ch=="("||(ch=="-"&&nch=="(")){if(ch=="-"){k++}nested=1;k++;while(k<st.length&&nested>0){ch=st.charAt(k);if(ch=="(")nested++;else if(ch==")")nested--;k++}}else if(ch>="a"&&ch<="z"||ch>="A"&&ch<="Z"){k++;while(k<st.length&&(ch=st.charAt(k))>="a"&&ch<="z"||ch>="A"&&ch<="Z")k++;if(ch=='('&&st.slice(i+1,k).match(/^(sin|cos|tan|sec|csc|cot|logten|log|ln|exp|arcsin|arccos|arctan|arcsec|arccsc|arccot|sinh|cosh|tanh|sech|csch|coth|arcsinh|arccosh|arctanh|arcsech|arccsch|arccoth|sqrt|abs|nthroot)$/)){nested=1;k++;while(k<st.length&&nested>0){ch=st.charAt(k);if(ch=="(")nested++;else if(ch==")")nested--;k++}}}else{return"Error: incorrect syntax in "+st+" at position "+k}st=st.slice(0,j+1)+"safepow("+st.slice(j+1,i)+","+st.slice(i+1,k)+")"+st.slice(k)}while((i=st.indexOf("!"))!=-1){if(i==0)return"Error: missing argument";j=i-1;ch=st.charAt(j);if(ch>="0"&&ch<="9"){j--;while(j>=0&&(ch=st.charAt(j))>="0"&&ch<="9")j--;if(ch=="."){j--;while(j>=0&&(ch=st.charAt(j))>="0"&&ch<="9")j--}}else if(ch==")"){nested=1;j--;while(j>=0&&nested>0){ch=st.charAt(j);if(ch=="(")nested--;else if(ch==")")nested++;j--}while(j>=0&&(ch=st.charAt(j))>="a"&&ch<="z"||ch>="A"&&ch<="Z")j--}else if(ch>="a"&&ch<="z"||ch>="A"&&ch<="Z"){j--;while(j>=0&&(ch=st.charAt(j))>="a"&&ch<="z"||ch>="A"&&ch<="Z")j--}else{return"Error: incorrect syntax in "+st+" at position "+j}st=st.slice(0,j+1)+"factorial("+st.slice(j+1,i)+")"+st.slice(i+1)}return st}
</script> 

<!--his disables the enter key  (from http://www.webcheatsheet.com/javascript/disable_enter_key.php-->
<script type="text/javascript"> 
function stopRKey(evt) { 
  var evt = (evt) ? evt : ((event) ? event : null); 
  var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null); 
  if ((evt.keyCode == 13) && (node.type=="text"))  {return false;} 
} 
document.onkeypress = stopRKey; 
</script>
<title>Formules van lijnen</title>
</head>

<body>

<h2>Formules van lijnen opstellen</h2>

<form>
<input type='button' OnClick='newLine(yChange,xChange,yInt)' value='Nieuwe lijn' button style='font-weight:bold; color:#FFFFFF; background-color:#006ae0;'>
</form>

<div id="jxgbox" class="jxgbox" style="width:500px; height:500px;"></div>

<script type="text/javascript">
//JXG.Options.text.useMathJax = true;

var b = JXG.JSXGraph.initBoard('jxgbox', {boundingbox: [-10, 10, 10, -10],axis:true,grid:true,showCopyright:false,showNavigation: false,
  keepaspectratio:true});
var yChange = 0;  
var xChange = 1;
var yInt = 0;
var slope = 0;
var eq = "";
var correctValue = 0;
var sameEq = 0;
var eqType;
var slopeSign;
var li = b.create('functiongraph',
  [function(x){ return 112;}],{strokeWidth:3, strokecolor:'#006ae0'});
var userLine;
var userGaveUp = false;
var problemComplete = false;
var problemsViewed = 0;
var problemsCorrect = 0;
var problemsCorrectTry1 = 0;
var score = 0;
var attempts = 0;


//This checks whether 2 and/or 3 are common factors of the slope numerator and denominator
function reduceFraction(){
var i=3;
     for (i=3;i>=2;i--){
     if (yChange%i==0 && xChange%i==0){
         yChange=yChange/i;
         xChange=xChange/i;
         }
     }
}

//This checks whether the input is an integer. From http://www.inventpartners.com/content/javascript_is_int
function is_int(value){ 
  if((parseFloat(value) == parseInt(value)) && !isNaN(value)){return true;}
  else {return false;} 
}

//This generates a pseudorandom integer between two values
function randomFromTo(from, to){
       return Math.floor(Math.random() * (to - from + 1) + from);
    }

function generateSlope (){
       yChange = randomFromTo(-5,5);
       xChange = randomFromTo(1,5);
       slope = yChange/xChange;
       if(!(is_int(slope))) {
           reduceFraction();
           }
    }

function generateIntercept(){
        yInt = randomFromTo(-8,8);
    }

function clearAll(){
        b = JXG.JSXGraph.freeBoard(b);
        b = JXG.JSXGraph.initBoard('jxgbox', {boundingbox: [-10, 10, 10, -10],axis:true,grid:true,showCopyright:false,
            keepaspectratio:true});
        document.getElementById('ansInput').value="";
}

//This determines how displayed equation should be formatted based on the slope
function identifyEqType(){
        if (slope==0) {eqType = 0} 
        else {if (is_int(slope)){if (abs(slope)==1) {eqType = 1} else {eqType = 2};}
              else {eqType = 3};       
        }; 
}


function newLine(){
      score = score - 20;
      problemsViewed++;
      attempts = 0;
      clearAll();
      userGaveUp = false;
      problemComplete = false;
      generateSlope();
      generateIntercept();
      li = b.create('functiongraph', [function(x){return eval(mathjs("slope*x+yInt","x"));}],{strokeWidth:3, strokecolor:'#006ae0'});
}

function displayEq(){
      eraseUserLines();
      if (!(userGaveUp)) {
          b.create('functiongraph', [function(x){return eval(mathjs(eq,"x"));}],{strokeWidth:3, strokeColor:'red'});
          userGaveUp = true;
};

      var p;  //this sets x-coordinate of displayed equation
      var q = 9;  //this sets y-coordinate of displayed equation
      var slopeSign;  //this adds a negative to the displayed equation in front of the slope
      var interceptSign;  //this adds a plus to the displayed equation in front of a positive intercept
      var interceptDisplay;  //this hides the intercept if it is zero
      if (slope > 0) {p = -9; slopeSign = ''} else {p = 3.1; slopeSign = '-'};
      if (yInt > 0) {interceptSign = '+ '} else {interceptSign = ''};
      if (yInt == 0) {interceptDisplay = ''} else {interceptDisplay = yInt};

      identifyEqType();
      
      switch(eqType)
      {
         case 0:   //slope is 0
             b.create('text',[p,q, function(){return '$${y = '+yInt+'}$$';}], {fontSize: 20});
             break;
         case 1:   //abs value of slope is 1
             b.create('text',[p,q, function(){return '$${y = '+slopeSign+'x'+interceptSign+interceptDisplay+'}$$';}], {fontSize: 20});
             break;
         case 2:   //abs value of slope is integer other than 1
             b.create('text',[p,q, function(){return '$${y = '+slope+'x '+interceptSign+interceptDisplay+'}$$';}], {fontSize: 20});
             break;         
         default:
             b.create('text',[p,q, function(){return '$${y = '+slopeSign+'\\tfrac{'+abs(yChange)+'}{'+xChange+'}x '+interceptSign+interceptDisplay+'}$$';}], {fontSize: 20});
           }
}

function compareValues() {
      correctValue = slope*(Math.PI)+yInt;
      if (correctValue == userLine.Y(Math.PI)) {sameEq = 1;}
      else {sameEq = 0;}
}

function graphUserEq(){
      attempts++;
      eq = document.getElementById('ansInput').value;    
      userLine = b.create('functiongraph', [function(x){return eval(mathjs(eq,"x"));}],{strokeWidth:3, strokeColor:'red'});
      compareValues();
      if(sameEq ==1) {displayEq()};   
}

function eraseUserLines(){
      clearAll();
      li = b.create('functiongraph', [function(x){return eval(mathjs("slope*x+yInt","x"));}],{strokeWidth:3, strokecolor:'#006ae0'});
}

function giveUp(){
      userGaveUp = true;
      displayEq()
}

</script>

<form onsubmit="graphUserEq(); return false;">
<p>
   De formule van deze lijn is \(y =\) <input type='text' id='ansInput' />
   <input type='button' onclick='graphUserEq()' value='Teken mijn lijn' button style='font-weight:bold; color:#FFFFFF; background-color:#CC3333;' /> 
</p>
   <input type='button' onclick='eraseUserLines()' value='Wis de rode lijn(en)' /> 
   <input type='button' onclick='giveUp()' value='Ik geef het op' /> 
</form>

<p style="height: 4em;">&nbsp;</p>
<p><small>Gebaseerd op een applet van <a href="http://www.continuousreflection.org/?p=140">Laura Kinnel</a>.
</small>
</p>

</body>
</html>
